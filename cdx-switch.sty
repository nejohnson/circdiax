% cd-switch.sty
%
% Derived from:
% from http://www.jokr.de/stefan/
% File created by Stefan Krause -- version 1.0.
%
% Extended by: Neil Johnson
%
% Supports additional switch and relay symbols for circdiax.sty.
\newcommand{\cdelemxfirst}{}
\newcommand{\cdelemyfirst}{}
\newcommand{\cdorientfirst}{}
% Relays
\newcommand{\relay}[6][]{
 \prepareelement{S}{relay}{#4}{#5}{#6}
 \renewcommand{\cdelemx}{#2}
 \renewcommand{\cdelemy}{#3}
 \begin{scope}[shift = {(#2, #3)}]
  \ifthenelse{\equal{\cdorient}{H}}{\relayH{#1}}{}
  \ifthenelse{\equal{\cdorient}{V}}{\relayV{#1}}{}
  \drawrefval
 \end{scope}
}
\newcommand{\relayH}[1]{
 \setstandardtextpos{ud}
 \placerefvalH{-2}{0}{2}{-3.75}{0}{3.75}
 #1
 \draw [cdmedlines] (-1.5, -2.45) rectangle (1.5, 2.45) (-1.5, -1.5) -- (1.5, 1.5);
 \draw (-1.5, 0) -- (-2, 0) (1.5, 0) -- (2, 0);
}
\newcommand{\relayV}[1]{
 \setstandardtextpos{r}
 \placerefvalV{-3}{0}{3}{-2.75}{0}{2.75}
 #1
 \draw [cdmedlines] (-2.45, -1.5) rectangle (2.45, 1.5) (-1.5, -1.5) -- (1.5, 1.5);
 \draw (0, -1.5) -- (0, -2) (0, 1.5) -- (0, 2);
}
\newcommand{\relayandswitch}[2]{
 #1
 \edef\cdelemxfirst{\cdelemx}
 \edef\cdelemyfirst{\cdelemy}
 \edef\cdorientfirst{\cdorient}
 #2
 \ifthenelse{\equal{\cdorientfirst}{H}}{
  \ifthenelse{\cdelemy>\cdelemyfirst}{
   \draw [dashed] (\cdelemxfirst, \cdelemyfirst+2.45) |- (\cdelemx, \cdelemy);
  }{}
  \ifthenelse{\cdelemy<\cdelemyfirst}{
   \draw [dashed] (\cdelemxfirst, \cdelemyfirst-2.45) |- (\cdelemx, \cdelemy);
  }{}
 }{}
 \ifthenelse{\equal{\cdorientfirst}{V}}{
  \ifthenelse{\cdelemx>\cdelemxfirst}{
   \draw [dashed] (\cdelemxfirst+2.45, \cdelemyfirst) -| (\cdelemx, \cdelemy);
  }{}
  \ifthenelse{\cdelemx<\cdelemxfirst}{
   \draw [dashed] (\cdelemxfirst-2.45, \cdelemyfirst) -| (\cdelemx, \cdelemy);
  }{}
 }{}
}
